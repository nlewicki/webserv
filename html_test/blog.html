<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>Mini-Blog</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>article{border:1px solid #ddd;padding:8px;border-radius:8px;margin:8px 0}</style>
</head>
<body>
  <h1>Mini-Blog</h1>

  <h2>Neuen Post anlegen (Form-POST)</h2>
  <form action="/blog" method="post" enctype="application/x-www-form-urlencoded">
    <input name="title" placeholder="Titel" required />
    <br />
    <textarea name="body" placeholder="Text" required></textarea><br />
    <button type="submit">POST /blog</button>
  </form>

  <h2>Liste</h2>
  <div id="list">(lädt…)</div>

  <h2>Löschen</h2>
  <form id="deleteForm">
    <input name="id" placeholder="ID" required />
    <button type="submit">DELETE /blog/{id}</button>
  </form>

  <script>
    async function loadList(){
      const r = await fetch('/blog', {headers:{'accept':'application/json'}});
      const data = r.ok ? await r.json() : [];
      const wrap = document.getElementById('list');
      wrap.innerHTML = '';
      for(const p of data){
        const el = document.createElement('article');
        el.innerHTML = `<strong>#${p.id} ${p.title}</strong><p>${p.body}</p>`;
        wrap.appendChild(el);
      }
    }
    document.getElementById('deleteForm').onsubmit = async (e)=>{
      e.preventDefault();
      const id = new FormData(e.target).get('id');
      const r = await fetch('/blog/'+encodeURIComponent(id), {method:'DELETE'});
      alert('Status: '+r.status);
      loadList();
    };
    loadList();
  </script>

  <h3>cURL-Beispiele</h3>
  <pre>
# POST (urlencoded)
curl -i -X POST http://localhost:8080/blog \
  -H "Content-Type: application/x-www-form-urlencoded" \
  --data "title=Hello&body=World"

# DELETE echt:
curl -i -X DELETE http://localhost:8080/blog/1

# DELETE via Method-Override:
curl -i -X POST "http://localhost:8080/blog?_method=DELETE" --data "id=1"
  </pre>
</body>
</html>
